<!DOCTYPE html>
<html lang="en" data-root="https://totallymoney.github.io/FsCDK/">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Edgar Gonzalez" name="author">
    <!-- Opengraph properties (https://ogp.me/) -->
    <meta property="og:site_name" content="FsCDK">
    <meta property="og:title" content="Multi-Tenant SaaS Patterns" />
    <meta property="og:url" content="https://totallymoney.github.io/FsCDK/multi-tenant-patterns.html">
    <meta property="og:type" content="website" />
    <!-- Twitter cards (https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/summary-card-with-large-image) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="https://totallymoney.github.io/FsCDK/">
    <meta name="twitter:title" content="Multi-Tenant SaaS Patterns">
    
    <title>Multi-Tenant SaaS Patterns | FsCDK</title>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="https://totallymoney.github.io/FsCDK/img/favicon.ico" rel="icon" sizes="32x32" type="image/png"/>
    <script type="application/javascript" src="https://totallymoney.github.io/FsCDK/content/fsdocs-theme-set-dark.js"></script>
    <link href="https://totallymoney.github.io/FsCDK/content/fsdocs-default.css" rel="stylesheet" type="text/css"/>
    <link href="https://totallymoney.github.io/FsCDK/content/fsdocs-theme.css" rel="stylesheet" type="text/css"/>
    
    
</head>
<body class="content">
<header>
    <div class="start">
        <div id="menu-toggle">
            <iconify-icon class="icon closed" height="22" icon="eva:menu-fill" width="22"></iconify-icon>
            <iconify-icon class="icon open" height="22" icon="mi:close" width="22"></iconify-icon>
            <input type="checkbox" name="mobile-menu" />
            <ul class="menu">
                <li class="nav-header">Links</li>
                <li class="nav-item"><a class="nav-link" href="https://github.com/totallymoney/FsCDK/blob/main/LICENSE">License</a>
                </li>
                <li class="nav-item"><a class="nav-link"
                                        href="https://github.com/totallymoney/FsCDK/blob/main/CHANGELOG.md">Release
                    Notes</a></li>
                <li class="nav-item"><a class="nav-link" href="https://github.com/totallymoney/FsCDK/">Source
                    Repository</a></li>
                <li class="nav-header ">
  Resources
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/alb-secrets-route53.html">
    Load Balancer, Secrets Manager, and Route 53 Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/api-gateway-v2.html">
    API Gateway V2 (HTTP API)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/bastion-host.html">
    Bastion Host
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/bucket-policy.html">
    S3 Bucket Policy
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/certificate-manager.html">
    Certificate Manager
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cloudtrail-audit-logging.html">
    CloudTrail Audit Logging
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cloudwatch-dashboard.html">
    CloudWatch Monitoring and Dashboards
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cognito-m2m-oauth.html">
    Cognito OAuth 2.0 Machine-to-Machine (M2M)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/dynamodb.html">
    DynamoDB Tables
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/ec2-ecs.html">
    EC2 and ECS Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/ecr-repository.html">
    ECR Repository (Container Registry)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/eks-kubernetes.html">
    EKS (Elastic Kubernetes Service) Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/eventbridge.html">
    EventBridge
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/kinesis-streams.html">
    Kinesis Streams Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/kms-encryption.html">
    KMS Key Management
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/lambda-powertools.html">
    Lambda Powertools Integration
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/lambda-production-defaults.html">
    Lambda Production Defaults
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/lambda-quickstart.html">
    Lambda Quickstart Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/managed-policy.html">
    Managed IAM Policy
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/network-load-balancer.html">
    Network Load Balancer
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/rds-database.html">
    RDS Relational Databases
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/s3-quickstart.html">
    S3 Quickstart Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/sns-sqs-messaging.html">
    SNS and SQS Messaging
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/step-functions.html">
    Step Functions (State Machines)
  </a>
</li>             
<li class="nav-header ">
  Testing
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/localstack-testing.html">
    Local Testing with LocalStack
  </a>
</li>             
<li class="nav-header ">
  Reference
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/aws-learning-resources.html">
    AWS Learning Resources
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/comparison-to-farmer.html">
    Comparison with Azure (Farmer F#) to AWS (FsCDK)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/feature-reference.html">
    Complete Feature Reference
  </a>
</li>             
<li class="nav-header ">
  Getting Started
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/getting-started-extended.html">
    Getting Started with FsCDK - Extended Features
  </a>
</li>             
<li class="nav-header active">
  Tutorials
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/multi-tenant-patterns.html">
    Multi-Tenant SaaS Patterns
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/multi-tier-example.html">
    FsCDK Multi-Tier Application Example
  </a>
</li>             
<li class="nav-header ">
  Best Practices
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/backup-and-disaster-recovery.html">
    Backup and Disaster Recovery on AWS
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cost-optimization-strategies.html">
    AWS Cost Optimization Strategies
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/governance-compliance-aws-organizations.html">
    Governance and Compliance with AWS Organizations
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/iam-best-practices.html">
    IAM Best Practices for FsCDK
  </a>
</li>             
<li class="nav-header ">
  Other
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/custom-resources.html">
    Production-grade custom resources with FsCDK

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/img/diagrams/README.html">
    FsCDK Documentation Diagrams

  </a>
</li>
                <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/reference/index.html">
    All Namespaces
  </a>
</li>
            </ul>
        </div>
        <a href="https://github.com/totallymoney/FsCDK">
            <img alt="Header menu logo" src="https://totallymoney.github.io/FsCDK/img/logo.png">
            <strong>FsCDK</strong>
        </a>
    </div>
    <div class="end">
        <a href="https://github.com/totallymoney/FsCDK/" target="_blank">
            <iconify-icon icon="uil:github" width="26" height="26"></iconify-icon>
        </a>
        <iconify-icon id="search-btn" icon="carbon:search" class="search" width="24" height="24"></iconify-icon>
        <fsdocs-theme-toggle></fsdocs-theme-toggle>
    </div>
</header>
<aside id="fsdocs-main-menu">
    <ul class="menu">
        <li class="nav-header">Links</li>
        <li class="nav-item"><a class="nav-link" href="https://github.com/totallymoney/FsCDK/blob/main/LICENSE">License</a>
        </li>
        <li class="nav-item"><a class="nav-link"
                                href="https://github.com/totallymoney/FsCDK/blob/main/CHANGELOG.md">Release
            Notes</a></li>
        <li class="nav-item"><a class="nav-link" href="https://github.com/totallymoney/FsCDK/">Source
            Repository</a></li>
        <li class="nav-header ">
  Resources
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/alb-secrets-route53.html">
    Load Balancer, Secrets Manager, and Route 53 Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/api-gateway-v2.html">
    API Gateway V2 (HTTP API)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/bastion-host.html">
    Bastion Host
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/bucket-policy.html">
    S3 Bucket Policy
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/certificate-manager.html">
    Certificate Manager
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cloudtrail-audit-logging.html">
    CloudTrail Audit Logging
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cloudwatch-dashboard.html">
    CloudWatch Monitoring and Dashboards
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cognito-m2m-oauth.html">
    Cognito OAuth 2.0 Machine-to-Machine (M2M)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/dynamodb.html">
    DynamoDB Tables
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/ec2-ecs.html">
    EC2 and ECS Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/ecr-repository.html">
    ECR Repository (Container Registry)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/eks-kubernetes.html">
    EKS (Elastic Kubernetes Service) Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/eventbridge.html">
    EventBridge
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/kinesis-streams.html">
    Kinesis Streams Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/kms-encryption.html">
    KMS Key Management
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/lambda-powertools.html">
    Lambda Powertools Integration
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/lambda-production-defaults.html">
    Lambda Production Defaults
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/lambda-quickstart.html">
    Lambda Quickstart Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/managed-policy.html">
    Managed IAM Policy
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/network-load-balancer.html">
    Network Load Balancer
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/rds-database.html">
    RDS Relational Databases
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/s3-quickstart.html">
    S3 Quickstart Example
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/sns-sqs-messaging.html">
    SNS and SQS Messaging
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/step-functions.html">
    Step Functions (State Machines)
  </a>
</li>             
<li class="nav-header ">
  Testing
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/localstack-testing.html">
    Local Testing with LocalStack
  </a>
</li>             
<li class="nav-header ">
  Reference
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/aws-learning-resources.html">
    AWS Learning Resources
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/comparison-to-farmer.html">
    Comparison with Azure (Farmer F#) to AWS (FsCDK)
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/feature-reference.html">
    Complete Feature Reference
  </a>
</li>             
<li class="nav-header ">
  Getting Started
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/getting-started-extended.html">
    Getting Started with FsCDK - Extended Features
  </a>
</li>             
<li class="nav-header active">
  Tutorials
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/multi-tenant-patterns.html">
    Multi-Tenant SaaS Patterns
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/multi-tier-example.html">
    FsCDK Multi-Tier Application Example
  </a>
</li>             
<li class="nav-header ">
  Best Practices
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/backup-and-disaster-recovery.html">
    Backup and Disaster Recovery on AWS
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/cost-optimization-strategies.html">
    AWS Cost Optimization Strategies
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/governance-compliance-aws-organizations.html">
    Governance and Compliance with AWS Organizations
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/iam-best-practices.html">
    IAM Best Practices for FsCDK
  </a>
</li>             
<li class="nav-header ">
  Other
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/custom-resources.html">
    Production-grade custom resources with FsCDK

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/img/diagrams/README.html">
    FsCDK Documentation Diagrams

  </a>
</li>
        <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://totallymoney.github.io/FsCDK/reference/index.html">
    All Namespaces
  </a>
</li>
    </ul>
</aside>
<main>
    <div id="content">
        
<h1><a name="Multi-Tenant-SaaS-Architecture-Patterns" class="anchor" href="#Multi-Tenant-SaaS-Architecture-Patterns">Multi-Tenant SaaS Architecture Patterns</a></h1>
<p>Build secure, isolated multi-tenant applications with tenant-specific data, credentials, and configurations.</p>
<h2><a name="Tenant-Isolation-Strategies" class="anchor" href="#Tenant-Isolation-Strategies">Tenant Isolation Strategies</a></h2>
<h3><a name="Schema-per-Tenant-PostgreSQL" class="anchor" href="#Schema-per-Tenant-PostgreSQL">Schema-per-Tenant (PostgreSQL)</a></h3>
<p>Isolate tenant data using PostgreSQL schemas with row-level security.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="pp">#r</span> <span class="s">&quot;../src/bin/Release/net8.0/publish/Amazon.JSII.Runtime.dll&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;../src/bin/Release/net8.0/publish/Constructs.dll&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;../src/bin/Release/net8.0/publish/Amazon.CDK.Lib.dll&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;../src/bin/Release/net8.0/publish/FsCDK.dll&quot;</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">FsCDK</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">Amazon</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">CDK</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 4)" onmouseover="showTip(event, 'fs2', 4)" class="id">Amazon</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="id">CDK</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="id">AWS</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="id">RDS</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 8)" onmouseover="showTip(event, 'fs2', 8)" class="id">Amazon</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 9)" onmouseover="showTip(event, 'fs3', 9)" class="id">CDK</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="id">AWS</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 11)" onmouseover="showTip(event, 'fs6', 11)" class="id">EC2</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 12)" onmouseover="showTip(event, 'fs2', 12)" class="id">Amazon</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 13)" onmouseover="showTip(event, 'fs3', 13)" class="id">CDK</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 14)" onmouseover="showTip(event, 'fs4', 14)" class="id">AWS</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 15)" onmouseover="showTip(event, 'fs7', 15)" class="id">DynamoDB</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 16)" onmouseover="showTip(event, 'fs2', 16)" class="id">Amazon</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 17)" onmouseover="showTip(event, 'fs3', 17)" class="id">CDK</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 18)" onmouseover="showTip(event, 'fs4', 18)" class="id">AWS</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs8', 19)" onmouseover="showTip(event, 'fs8', 19)" class="id">SecretsManager</span>
</code></pre>
<h2><a name="Tenant-Registry-Pattern" class="anchor" href="#Tenant-Registry-Pattern">Tenant Registry Pattern</a></h2>
<p>Use DynamoDB to track tenant metadata, status, and configuration.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 20)" onmouseover="showTip(event, 'fs9', 20)" class="fn">stack</span> <span class="s">&quot;TenantRegistry&quot;</span> <span class="pn">{</span>
    <span class="c">// Central tenant registry</span>
    <span onmouseout="hideTip(event, 'fs10', 21)" onmouseover="showTip(event, 'fs10', 21)" class="fn">table</span> <span class="s">&quot;tenant-registry&quot;</span> <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs11', 22)" onmouseover="showTip(event, 'fs11', 22)" class="k">partitionKey</span> <span class="s">&quot;tenantId&quot;</span> <span onmouseout="hideTip(event, 'fs12', 23)" onmouseover="showTip(event, 'fs12', 23)" class="en">AttributeType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="id">STRING</span>
        <span onmouseout="hideTip(event, 'fs14', 25)" onmouseover="showTip(event, 'fs14', 25)" class="k">sortKey</span> <span class="s">&quot;environment&quot;</span> <span onmouseout="hideTip(event, 'fs12', 26)" onmouseover="showTip(event, 'fs12', 26)" class="en">AttributeType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="id">STRING</span>
        <span onmouseout="hideTip(event, 'fs15', 28)" onmouseover="showTip(event, 'fs15', 28)" class="k">billingMode</span> <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="en">BillingMode</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs17', 30)" onmouseover="showTip(event, 'fs17', 30)" class="id">PAY_PER_REQUEST</span>
        <span onmouseout="hideTip(event, 'fs18', 31)" onmouseover="showTip(event, 'fs18', 31)" class="k">pointInTimeRecovery</span> <span class="k">true</span>

        <span class="c">// Global Secondary Index for querying by status</span>
        <span onmouseout="hideTip(event, 'fs19', 32)" onmouseover="showTip(event, 'fs19', 32)" class="k">globalSecondaryIndexWithSort</span> <span class="s">&quot;status-index&quot;</span> <span class="pn">(</span><span class="s">&quot;status&quot;</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs12', 33)" onmouseover="showTip(event, 'fs12', 33)" class="en">AttributeType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs13', 34)" onmouseover="showTip(event, 'fs13', 34)" class="id">STRING</span><span class="pn">)</span> <span class="pn">(</span><span class="s">&quot;createdAt&quot;</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs12', 35)" onmouseover="showTip(event, 'fs12', 35)" class="en">AttributeType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs13', 36)" onmouseover="showTip(event, 'fs13', 36)" class="id">STRING</span><span class="pn">)</span>
    <span class="pn">}</span>

    <span class="c">// Tenant configuration data</span>
    <span onmouseout="hideTip(event, 'fs10', 37)" onmouseover="showTip(event, 'fs10', 37)" class="fn">table</span> <span class="s">&quot;tenant-config&quot;</span> <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs11', 38)" onmouseover="showTip(event, 'fs11', 38)" class="k">partitionKey</span> <span class="s">&quot;tenantId&quot;</span> <span onmouseout="hideTip(event, 'fs12', 39)" onmouseover="showTip(event, 'fs12', 39)" class="en">AttributeType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs13', 40)" onmouseover="showTip(event, 'fs13', 40)" class="id">STRING</span>
        <span onmouseout="hideTip(event, 'fs14', 41)" onmouseover="showTip(event, 'fs14', 41)" class="k">sortKey</span> <span class="s">&quot;configKey&quot;</span> <span onmouseout="hideTip(event, 'fs12', 42)" onmouseover="showTip(event, 'fs12', 42)" class="en">AttributeType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs13', 43)" onmouseover="showTip(event, 'fs13', 43)" class="id">STRING</span>
        <span onmouseout="hideTip(event, 'fs15', 44)" onmouseover="showTip(event, 'fs15', 44)" class="k">billingMode</span> <span onmouseout="hideTip(event, 'fs16', 45)" onmouseover="showTip(event, 'fs16', 45)" class="en">BillingMode</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs17', 46)" onmouseover="showTip(event, 'fs17', 46)" class="id">PAY_PER_REQUEST</span>
        <span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="k">stream</span> <span onmouseout="hideTip(event, 'fs21', 48)" onmouseover="showTip(event, 'fs21', 48)" class="en">StreamViewType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs22', 49)" onmouseover="showTip(event, 'fs22', 49)" class="id">NEW_AND_OLD_IMAGES</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<h2><a name="Per-Tenant-Secrets" class="anchor" href="#Per-Tenant-Secrets">Per-Tenant Secrets</a></h2>
<p>Store tenant-specific API keys, credentials, and configuration in Secrets Manager.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 50)" onmouseover="showTip(event, 'fs9', 50)" class="fn">stack</span> <span class="s">&quot;TenantSecrets&quot;</span> <span class="pn">{</span>
    <span class="c">// Template for tenant secrets (create per tenant programmatically)</span>
    <span onmouseout="hideTip(event, 'fs23', 51)" onmouseover="showTip(event, 'fs23', 51)" class="fn">secret</span> <span class="s">&quot;tenant-template-config&quot;</span> <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs24', 52)" onmouseover="showTip(event, 'fs24', 52)" class="k">description</span> <span class="s">&quot;Template for tenant-specific configuration&quot;</span>

        <span class="c">// Store tenant-specific secrets like:</span>
        <span class="c">// - API keys for third-party services</span>
        <span class="c">// - Database credentials</span>
        <span class="c">// - Encryption keys</span>
        <span onmouseout="hideTip(event, 'fs25', 53)" onmouseover="showTip(event, 'fs25', 53)" class="k">generateSecretString</span> <span class="pn">(</span>
            <span onmouseout="hideTip(event, 'fs26', 54)" onmouseover="showTip(event, 'fs26', 54)" class="m">SecretsManagerHelpers</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs27', 55)" onmouseover="showTip(event, 'fs27', 55)" class="id">generateJsonSecret</span> <span class="s">&quot;&quot;&quot;{&quot;apiEndpoint&quot;: &quot;https://api.example.com&quot;}&quot;&quot;&quot;</span> <span class="s">&quot;apiKey&quot;</span>
        <span class="pn">)</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<h2><a name="Multi-Tenant-Database-Architecture" class="anchor" href="#Multi-Tenant-Database-Architecture">Multi-Tenant Database Architecture</a></h2>
<h3><a name="Option-1-Schema-per-Tenant-Single-Database" class="anchor" href="#Option-1-Schema-per-Tenant-Single-Database">Option 1: Schema-per-Tenant (Single Database)</a></h3>
<p>Best for: 100-1000 tenants, simplified operations, cost efficiency</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 56)" onmouseover="showTip(event, 'fs9', 56)" class="fn">stack</span> <span class="s">&quot;SchemaPerTenant&quot;</span> <span class="pn">{</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 57)" onmouseover="showTip(event, 'fs28', 57)" class="fn">appVpc</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 58)" onmouseover="showTip(event, 'fs29', 58)" class="fn">vpc</span> <span class="s">&quot;AppVPC&quot;</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="k">maxAzs</span> <span class="n">2</span> <span class="pn">}</span>

    <span onmouseout="hideTip(event, 'fs31', 60)" onmouseover="showTip(event, 'fs31', 60)" class="fn">rdsInstance</span> <span class="s">&quot;SharedDatabase&quot;</span> <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs32', 61)" onmouseover="showTip(event, 'fs32', 61)" class="k">vpc</span> <span onmouseout="hideTip(event, 'fs28', 62)" onmouseover="showTip(event, 'fs28', 62)" class="fn">appVpc</span>
        <span onmouseout="hideTip(event, 'fs33', 63)" onmouseover="showTip(event, 'fs33', 63)" class="k">postgresEngine</span> <span onmouseout="hideTip(event, 'fs34', 64)" onmouseover="showTip(event, 'fs34', 64)" class="rt">PostgresEngineVersion</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 65)" onmouseover="showTip(event, 'fs35', 65)" class="id">VER_15</span>
        <span onmouseout="hideTip(event, 'fs36', 66)" onmouseover="showTip(event, 'fs36', 66)" class="k">instanceType</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs37', 67)" onmouseover="showTip(event, 'fs37', 67)" class="rt">InstanceType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 68)" onmouseover="showTip(event, 'fs38', 68)" class="id">Of</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs39', 69)" onmouseover="showTip(event, 'fs39', 69)" class="en">InstanceClass</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs40', 70)" onmouseover="showTip(event, 'fs40', 70)" class="id">MEMORY5</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs41', 71)" onmouseover="showTip(event, 'fs41', 71)" class="en">InstanceSize</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 72)" onmouseover="showTip(event, 'fs42', 72)" class="id">LARGE</span><span class="pn">)</span><span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs43', 73)" onmouseover="showTip(event, 'fs43', 73)" class="k">databaseName</span> <span class="s">&quot;multitenant&quot;</span>

        <span class="c">// Large instance for many tenants</span>
        <span onmouseout="hideTip(event, 'fs44', 74)" onmouseover="showTip(event, 'fs44', 74)" class="k">allocatedStorage</span> <span class="n">100</span>
        <span onmouseout="hideTip(event, 'fs45', 75)" onmouseover="showTip(event, 'fs45', 75)" class="k">multiAz</span> <span class="k">true</span>

        <span class="c">// Enable IAM authentication for application access</span>
        <span onmouseout="hideTip(event, 'fs46', 76)" onmouseover="showTip(event, 'fs46', 76)" class="k">iamAuthentication</span> <span class="k">true</span>

        <span class="c">// Strong encryption for tenant data</span>
        <span onmouseout="hideTip(event, 'fs47', 77)" onmouseover="showTip(event, 'fs47', 77)" class="k">storageEncrypted</span> <span class="k">true</span>
        <span onmouseout="hideTip(event, 'fs48', 78)" onmouseover="showTip(event, 'fs48', 78)" class="k">deletionProtection</span> <span class="k">true</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<h3><a name="PostgreSQL-Schema-Isolation-Pattern" class="anchor" href="#PostgreSQL-Schema-Isolation-Pattern">PostgreSQL Schema Isolation Pattern</a></h3>
<table class="pre"><tr><td class="snippet"><pre class="fssnip highlighted"><code lang="sql"><span class="c">-- Create tenant-specific schema</span>
<span class="k">CREATE</span> <span class="k">SCHEMA</span> tenant_acme;

<span class="c">-- Row-level security policy</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> tenant_acme.users ENABLE <span class="k">ROW</span> <span class="k">LEVEL</span> SECURITY;

<span class="k">CREATE</span> POLICY tenant_isolation <span class="k">ON</span> tenant_acme.users
    <span class="k">USING</span> (tenant_id = current_setting(<span class="s">'app.current_tenant_id'</span>)::UUID);

<span class="c">-- Grant application user access</span>
<span class="k">GRANT</span> <span class="k">USAGE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> tenant_acme <span class="k">TO</span> app_user;
<span class="k">GRANT</span> <span class="k">SELECT</span>, <span class="k">INSERT</span>, <span class="k">UPDATE</span>, <span class="k">DELETE</span> <span class="k">ON</span> <span class="k">ALL</span> TABLES <span class="k">IN</span> <span class="k">SCHEMA</span> tenant_acme <span class="k">TO</span> app_user;
</code></pre></td></tr></table>
<h3><a name="Option-2-Database-per-Tenant-Large-Tenants" class="anchor" href="#Option-2-Database-per-Tenant-Large-Tenants">Option 2: Database-per-Tenant (Large Tenants)</a></h3>
<p>Best for: &lt;100 tenants, enterprise customers, regulatory isolation</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs9', 79)" onmouseover="showTip(event, 'fs9', 79)" class="fn">stack</span> <span class="s">&quot;DatabasePerTenant&quot;</span> <span class="pn">{</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 80)" onmouseover="showTip(event, 'fs28', 80)" class="fn">appVpc</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 81)" onmouseover="showTip(event, 'fs29', 81)" class="fn">vpc</span> <span class="s">&quot;AppVPC&quot;</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs30', 82)" onmouseover="showTip(event, 'fs30', 82)" class="k">maxAzs</span> <span class="n">2</span> <span class="pn">}</span>

    <span class="c">// Template - deploy per large tenant</span>
    <span onmouseout="hideTip(event, 'fs31', 83)" onmouseover="showTip(event, 'fs31', 83)" class="fn">rdsInstance</span> <span class="s">&quot;EnterpriseCustomerDB&quot;</span> <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs32', 84)" onmouseover="showTip(event, 'fs32', 84)" class="k">vpc</span> <span onmouseout="hideTip(event, 'fs28', 85)" onmouseover="showTip(event, 'fs28', 85)" class="fn">appVpc</span>
        <span onmouseout="hideTip(event, 'fs33', 86)" onmouseover="showTip(event, 'fs33', 86)" class="k">postgresEngine</span> <span onmouseout="hideTip(event, 'fs34', 87)" onmouseover="showTip(event, 'fs34', 87)" class="rt">PostgresEngineVersion</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 88)" onmouseover="showTip(event, 'fs35', 88)" class="id">VER_15</span>
        <span onmouseout="hideTip(event, 'fs36', 89)" onmouseover="showTip(event, 'fs36', 89)" class="k">instanceType</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs37', 90)" onmouseover="showTip(event, 'fs37', 90)" class="rt">InstanceType</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 91)" onmouseover="showTip(event, 'fs38', 91)" class="id">Of</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs39', 92)" onmouseover="showTip(event, 'fs39', 92)" class="en">InstanceClass</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs40', 93)" onmouseover="showTip(event, 'fs40', 93)" class="id">MEMORY5</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs41', 94)" onmouseover="showTip(event, 'fs41', 94)" class="en">InstanceSize</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs49', 95)" onmouseover="showTip(event, 'fs49', 95)" class="id">XLARGE</span><span class="pn">)</span><span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs43', 96)" onmouseover="showTip(event, 'fs43', 96)" class="k">databaseName</span> <span class="s">&quot;enterprise_tenant&quot;</span>

        <span onmouseout="hideTip(event, 'fs45', 97)" onmouseover="showTip(event, 'fs45', 97)" class="k">multiAz</span> <span class="k">true</span>
        <span onmouseout="hideTip(event, 'fs50', 98)" onmouseover="showTip(event, 'fs50', 98)" class="k">backupRetentionDays</span> <span class="n">30.0</span>

        <span onmouseout="hideTip(event, 'fs47', 99)" onmouseover="showTip(event, 'fs47', 99)" class="k">storageEncrypted</span> <span class="k">true</span>
        <span onmouseout="hideTip(event, 'fs48', 100)" onmouseover="showTip(event, 'fs48', 100)" class="k">deletionProtection</span> <span class="k">true</span>
        <span onmouseout="hideTip(event, 'fs51', 101)" onmouseover="showTip(event, 'fs51', 101)" class="k">enablePerformanceInsights</span> <span class="k">true</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<h2><a name="Tenant-Context-Middleware-Pattern" class="anchor" href="#Tenant-Context-Middleware-Pattern">Tenant Context Middleware Pattern</a></h2>
<p>Pass tenant context through request headers for isolation.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// API Gateway passes tenant ID from authorizer</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 102)" onmouseover="showTip(event, 'fs52', 102)" class="id">tenantId</span> <span class="o">=</span> <span class="id">request</span><span class="pn">.</span><span class="id">Headers</span><span class="pn">.</span><span class="pn">[</span><span class="s">&quot;X-Tenant-ID&quot;</span><span class="pn">]</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs53', 103)" onmouseover="showTip(event, 'fs53', 103)" class="id">tenantRole</span> <span class="o">=</span> <span class="id">request</span><span class="pn">.</span><span class="id">Headers</span><span class="pn">.</span><span class="pn">[</span><span class="s">&quot;X-Tenant-Role&quot;</span><span class="pn">]</span>

<span class="c">// Set PostgreSQL session variable for RLS</span>
<span class="id">Database</span><span class="pn">.</span><span class="id">executeRaw</span> <span class="s">$&quot;SET app.current_tenant_id = &#39;{</span><span onmouseout="hideTip(event, 'fs52', 104)" onmouseover="showTip(event, 'fs52', 104)" class="id">tenantId</span><span class="s">}&#39;&quot;</span>

<span class="c">// All queries now isolated to tenant</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 105)" onmouseover="showTip(event, 'fs54', 105)" class="id">users</span> <span class="o">=</span> <span class="id">Users</span><span class="pn">.</span><span class="id">getAll</span><span class="pn">(</span><span class="pn">)</span> <span class="c">// Only returns tenant&#39;s users</span>
</code></pre>
<h2><a name="Cost-Optimization-by-Tenant-Tier" class="anchor" href="#Cost-Optimization-by-Tenant-Tier">Cost Optimization by Tenant Tier</a></h2>
<p>Adjust infrastructure based on tenant size/importance:</p>
<table>
<thead>
<tr class="header">
<th><p>Tier</p></th>
<th><p>Database</p></th>
<th><p>Backup</p></th>
<th><p>Instance</p></th>
<th><p>Monthly Cost</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Free</strong></p></td>
<td><p>Shared schema</p></td>
<td><p>1 day</p></td>
<td><p>Shared</p></td>
<td><p>~$0</p></td>
</tr>
<tr class="even">
<td><p><strong>Standard</strong></p></td>
<td><p>Shared schema</p></td>
<td><p>7 days</p></td>
<td><p>Shared</p></td>
<td><p>~$5/tenant</p></td>
</tr>
<tr class="odd">
<td><p><strong>Premium</strong></p></td>
<td><p>Shared schema</p></td>
<td><p>30 days</p></td>
<td><p>Shared</p></td>
<td><p>~$15/tenant</p></td>
</tr>
<tr class="even">
<td><p><strong>Enterprise</strong></p></td>
<td><p>Dedicated DB</p></td>
<td><p>30 days</p></td>
<td><p>Dedicated</p></td>
<td><p>~$500+/tenant</p></td>
</tr>
</tbody>
</table>

<h2><a name="Security-Best-Practices" class="anchor" href="#Security-Best-Practices">Security Best Practices</a></h2>
<h3><a name="Tenant-Isolation-Checklist" class="anchor" href="#Tenant-Isolation-Checklist">Tenant Isolation Checklist</a></h3>
<ul>
<li>[x] Database row-level security (RLS) enforced</li>
<li>[x] Application validates tenant ID on every request</li>
<li>[x] Secrets isolated per tenant in Secrets Manager</li>
<li>[x] CloudWatch logs include tenant context</li>
<li>[x] IAM policies scoped to tenant resources</li>
<li>[x] Audit trail includes tenant ID</li>
<li>[x] Cross-tenant queries blocked at database level</li>
</ul>
<h3><a name="Prevent-Cross-Tenant-Data-Leaks" class="anchor" href="#Prevent-Cross-Tenant-Data-Leaks">Prevent Cross-Tenant Data Leaks</a></h3>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// ❌ BAD: No tenant filtering</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 106)" onmouseover="showTip(event, 'fs55', 106)" class="id">user</span> <span class="o">=</span> <span class="id">Users</span><span class="pn">.</span><span class="id">getById</span><span class="pn">(</span><span class="id">userId</span><span class="pn">)</span>

<span class="c">// ✅ GOOD: Always include tenant context</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 107)" onmouseover="showTip(event, 'fs55', 107)" class="id">user</span> <span class="o">=</span> <span class="id">Users</span><span class="pn">.</span><span class="id">getById</span><span class="pn">(</span><span class="id">userId</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs52', 108)" onmouseover="showTip(event, 'fs52', 108)" class="id">tenantId</span><span class="pn">)</span>

<span class="c">// ✅ BETTER: Tenant context in session</span>
<span class="id">Database</span><span class="pn">.</span><span class="id">setTenantContext</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs52', 109)" onmouseover="showTip(event, 'fs52', 109)" class="id">tenantId</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 110)" onmouseover="showTip(event, 'fs55', 110)" class="id">user</span> <span class="o">=</span> <span class="id">Users</span><span class="pn">.</span><span class="id">getById</span><span class="pn">(</span><span class="id">userId</span><span class="pn">)</span> <span class="c">// RLS enforces isolation</span>
</code></pre>
<h2><a name="Tenant-Provisioning-Workflow" class="anchor" href="#Tenant-Provisioning-Workflow">Tenant Provisioning Workflow</a></h2>
<ol>
<li><strong>Create tenant record</strong> in DynamoDB registry</li>
<li><strong>Generate secrets</strong> in Secrets Manager</li>
<li><strong>Provision database schema</strong> (if schema-per-tenant)</li>
<li><strong>Create IAM users/roles</strong> (if dedicated resources)</li>
<li><strong>Initialize default data</strong> for new tenant</li>
<li><strong>Mark tenant as active</strong> in registry</li>
</ol>
<h2><a name="Monitoring-Multi-Tenant-Systems" class="anchor" href="#Monitoring-Multi-Tenant-Systems">Monitoring Multi-Tenant Systems</a></h2>
<p>Tag CloudWatch metrics with tenant ID for per-tenant observability in your application code (not IaC).
Use AWS SDK CloudWatch client to emit metrics with tenant dimensions.</p>
<h2><a name="Resources" class="anchor" href="#Resources">Resources</a></h2>
<ul>
<li><a href="https://docs.aws.amazon.com/whitepapers/latest/saas-architecture-fundamentals-aws/multi-tenant-saas-architecture.html">AWS Multi-Tenant SaaS Architecture</a></li>
<li><a href="https://www.postgresql.org/docs/current/ddl-rowsecurity.html">PostgreSQL Row Level Security</a></li>
<li><a href="https://aws.amazon.com/partners/programs/saas-factory/">AWS SaaS Factory</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/sharding">Multi-Tenant Database Patterns</a></li>
</ul>

        <div class="fsdocs-tip" id="fs1">namespace FsCDK</div>
<div class="fsdocs-tip" id="fs2">namespace Amazon</div>
<div class="fsdocs-tip" id="fs3">namespace Amazon.CDK</div>
<div class="fsdocs-tip" id="fs4">namespace Amazon.CDK.AWS</div>
<div class="fsdocs-tip" id="fs5">namespace Amazon.CDK.AWS.RDS</div>
<div class="fsdocs-tip" id="fs6">namespace Amazon.CDK.AWS.EC2</div>
<div class="fsdocs-tip" id="fs7">namespace Amazon.CDK.AWS.DynamoDB</div>
<div class="fsdocs-tip" id="fs8">namespace Amazon.CDK.AWS.SecretsManager</div>
<div class="fsdocs-tip" id="fs9">val stack: name: string -&gt; StackBuilder<br /><em>&lt;summary&gt;Creates an AWS CDK Stack construct.&lt;/summary&gt;<br />&lt;param name=&quot;name&quot;&gt;The name of the stack.&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 stack &quot;MyStack&quot; {
     lambda myFunction
     bucket myBucket
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs10">val table: name: string -&gt; TableBuilder<br /><em>&lt;summary&gt;Creates a DynamoDB table configuration.&lt;/summary&gt;<br />&lt;param name=&quot;name&quot;&gt;The table name.&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     partitionKey &quot;id&quot; AttributeType.STRING
     billingMode BillingMode.PAY_PER_REQUEST
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs11">custom operation: partitionKey (string) (AttributeType)

Calls TableBuilder.PartitionKey<br /><em>&lt;summary&gt;Sets the partition key for the table.&lt;/summary&gt;<br />&lt;param name=&quot;name&quot;&gt;The attribute name for the partition key.&lt;/param&gt;<br />&lt;param name=&quot;attrType&quot;&gt;The attribute type (STRING, NUMBER, or BINARY).&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     partitionKey &quot;id&quot; AttributeType.STRING
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs12">[&lt;Struct&gt;]
type AttributeType =
  | BINARY = 0
  | NUMBER = 1
  | STRING = 2</div>
<div class="fsdocs-tip" id="fs13">field AttributeType.STRING: AttributeType = 2</div>
<div class="fsdocs-tip" id="fs14">custom operation: sortKey (string) (AttributeType)

Calls TableBuilder.SortKey<br /><em>&lt;summary&gt;Sets the sort key for the table.&lt;/summary&gt;<br />&lt;param name=&quot;name&quot;&gt;The attribute name for the sort key.&lt;/param&gt;<br />&lt;param name=&quot;attrType&quot;&gt;The attribute type (STRING, NUMBER, or BINARY).&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     partitionKey &quot;userId&quot; AttributeType.STRING
     sortKey &quot;timestamp&quot; AttributeType.NUMBER
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs15">custom operation: billingMode (BillingMode)

Calls TableBuilder.BillingMode<br /><em>&lt;summary&gt;Sets the billing mode for the table.&lt;/summary&gt;<br />&lt;param name=&quot;mode&quot;&gt;The billing mode (PAY_PER_REQUEST or PROVISIONED).&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     billingMode BillingMode.PAY_PER_REQUEST
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs16">[&lt;Struct&gt;]
type BillingMode =
  | PAY_PER_REQUEST = 0
  | PROVISIONED = 1</div>
<div class="fsdocs-tip" id="fs17">field BillingMode.PAY_PER_REQUEST: BillingMode = 0</div>
<div class="fsdocs-tip" id="fs18">custom operation: pointInTimeRecovery (bool)

Calls TableBuilder.PointInTimeRecovery<br /><em>&lt;summary&gt;Enables or disables point-in-time recovery.&lt;/summary&gt;<br />&lt;param name=&quot;enabled&quot;&gt;Whether point-in-time recovery is enabled.&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     pointInTimeRecovery true
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs19">custom operation: globalSecondaryIndexWithSort (string) (string * AttributeType) (string * AttributeType)

Calls TableBuilder.GlobalSecondaryIndexWithSort<br /><em>&lt;summary&gt;Adds a Global Secondary Index with a sort key.&lt;/summary&gt;<br />&lt;param name=&quot;indexName&quot;&gt;The name of the GSI.&lt;/param&gt;<br />&lt;param name=&quot;partitionKey&quot;&gt;The GSI partition key (attribute name and type).&lt;/param&gt;<br />&lt;param name=&quot;sortKey&quot;&gt;The GSI sort key (attribute name and type).&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     partitionKey &quot;pk&quot; AttributeType.STRING
     sortKey &quot;sk&quot; AttributeType.STRING
     globalSecondaryIndexWithSort &quot;GSI1&quot; (&quot;gsi1pk&quot;, AttributeType.STRING) (&quot;gsi1sk&quot;, AttributeType.STRING)
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs20">custom operation: stream (StreamViewType)

Calls TableBuilder.Stream<br /><em>&lt;summary&gt;Enables DynamoDB Streams for the table.&lt;/summary&gt;<br />&lt;param name=&quot;streamType&quot;&gt;The stream view type (KEYS_ONLY, NEW_IMAGE, OLD_IMAGE, or NEW_AND_OLD_IMAGES).&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 table &quot;MyTable&quot; {
     stream StreamViewType.NEW_AND_OLD_IMAGES
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs21">[&lt;Struct&gt;]
type StreamViewType =
  | NEW_IMAGE = 0
  | OLD_IMAGE = 1
  | NEW_AND_OLD_IMAGES = 2
  | KEYS_ONLY = 3</div>
<div class="fsdocs-tip" id="fs22">field StreamViewType.NEW_AND_OLD_IMAGES: StreamViewType = 2</div>
<div class="fsdocs-tip" id="fs23">val secret: name: string -&gt; SecretsManagerBuilder<br /><em>&lt;summary&gt;
 Creates a new Secrets Manager secret builder with secure defaults.
 Example: secret &quot;my-api-key&quot; { description &quot;API key for external service&quot; }
 &lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs24">custom operation: description (string)

Calls SecretsManagerBuilder.Description</div>
<div class="fsdocs-tip" id="fs25">custom operation: generateSecretString (SecretStringGenerator)

Calls SecretsManagerBuilder.GenerateSecretString</div>
<div class="fsdocs-tip" id="fs26">module SecretsManagerHelpers

from FsCDK<br /><em>&lt;summary&gt;
 Helper functions for creating secret string generators
 &lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs27">val generateJsonSecret: secretStringTemplate: string -&gt; generateStringKey: string -&gt; SecretStringGenerator<br /><em>&lt;summary&gt;
 Creates a secret string generator for JSON secrets (e.g., database credentials)
 &lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs28">val appVpc: VpcSpec</div>
<div class="fsdocs-tip" id="fs29">val vpc: name: string -&gt; VpcBuilder<br /><em>&lt;summary&gt;Creates a VPC configuration with AWS best practices.&lt;/summary&gt;<br />&lt;param name=&quot;name&quot;&gt;The VPC name.&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 vpc &quot;MyVpc&quot; {
     maxAzs 2
     natGateways 1
     cidr &quot;10.0.0.0/16&quot;
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs30">custom operation: maxAzs (int)

Calls VpcBuilder.MaxAzs<br /><em>&lt;summary&gt;Sets the maximum number of Availability Zones to use.&lt;/summary&gt;<br />&lt;param name=&quot;maxAzs&quot;&gt;The maximum number of AZs (default: 2 for HA).&lt;/param&gt;</em></div>
<div class="fsdocs-tip" id="fs31">val rdsInstance: name: string -&gt; DatabaseInstanceBuilder<br /><em>&lt;summary&gt;Creates an RDS Database Instance with AWS best practices.&lt;/summary&gt;<br />&lt;param name=&quot;name&quot;&gt;The database instance name.&lt;/param&gt;<br />&lt;code lang=&quot;fsharp&quot;&gt;
 rdsInstance &quot;MyDatabase&quot; {
     vpc myVpc
     postgresEngine PostgresEngineVersion.VER_15
     instanceType (InstanceType.Of(InstanceClass.BURSTABLE3, InstanceSize.SMALL))
     multiAz true
     backupRetentionDays 7.0
 }
 &lt;/code&gt;</em></div>
<div class="fsdocs-tip" id="fs32">custom operation: vpc (VpcSpec)

Calls DatabaseInstanceBuilder.Vpc<br /><em>&lt;summary&gt;Sets the VPC.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs33">custom operation: postgresEngine (PostgresEngineVersion option)

Calls DatabaseInstanceBuilder.PostgresEngine<br /><em>&lt;summary&gt;Sets PostgreSQL as the database engine with specific version.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs34">type PostgresEngineVersion =
  inherit DeputyBase
  static member Of: postgresFullVersion: string * postgresMajorVersion: string * ?postgresFeatures: IPostgresEngineFeatures -&gt; PostgresEngineVersion
  member PostgresFullVersion: string
  member PostgresMajorVersion: string
  static member VER_10: PostgresEngineVersion
  static member VER_10_1: PostgresEngineVersion
  static member VER_10_10: PostgresEngineVersion
  static member VER_10_11: PostgresEngineVersion
  static member VER_10_12: PostgresEngineVersion
  static member VER_10_13: PostgresEngineVersion
  ...</div>
<div class="fsdocs-tip" id="fs35">property PostgresEngineVersion.VER_15: PostgresEngineVersion with get</div>
<div class="fsdocs-tip" id="fs36">custom operation: instanceType (InstanceType)

Calls DatabaseInstanceBuilder.InstanceType<br /><em>&lt;summary&gt;Sets the instance type.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs37">Multiple items<br />type InstanceType =
  inherit DeputyBase
  new: instanceTypeIdentifier: string -&gt; unit
  member IsBurstable: unit -&gt; bool
  member SameInstanceClassAs: other: InstanceType -&gt; bool
  member ToString: unit -&gt; string
  static member Of: instanceClass: InstanceClass * instanceSize: InstanceSize -&gt; InstanceType
  member Architecture: InstanceArchitecture<br /><br />--------------------<br />InstanceType(instanceTypeIdentifier: string) : InstanceType</div>
<div class="fsdocs-tip" id="fs38">InstanceType.Of(instanceClass: InstanceClass, instanceSize: InstanceSize) : InstanceType</div>
<div class="fsdocs-tip" id="fs39">[&lt;Struct&gt;]
type InstanceClass =
  | STANDARD3 = 0
  | M3 = 1
  | STANDARD4 = 2
  | M4 = 3
  | STANDARD5 = 4
  | M5 = 5
  | STANDARD5_NVME_DRIVE = 6
  | M5D = 7
  | STANDARD5_AMD = 8
  | M5A = 9
  ...</div>
<div class="fsdocs-tip" id="fs40">field InstanceClass.MEMORY5: InstanceClass = 22</div>
<div class="fsdocs-tip" id="fs41">[&lt;Struct&gt;]
type InstanceSize =
  | NANO = 0
  | MICRO = 1
  | SMALL = 2
  | MEDIUM = 3
  | LARGE = 4
  | XLARGE = 5
  | XLARGE2 = 6
  | XLARGE3 = 7
  | XLARGE4 = 8
  | XLARGE6 = 9
  ...</div>
<div class="fsdocs-tip" id="fs42">field InstanceSize.LARGE: InstanceSize = 4</div>
<div class="fsdocs-tip" id="fs43">custom operation: databaseName (string)

Calls DatabaseInstanceBuilder.DatabaseName<br /><em>&lt;summary&gt;Sets the database name.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs44">custom operation: allocatedStorage (int)

Calls DatabaseInstanceBuilder.AllocatedStorage<br /><em>&lt;summary&gt;Sets the allocated storage in GB.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs45">custom operation: multiAz (bool)

Calls DatabaseInstanceBuilder.MultiAz<br /><em>&lt;summary&gt;Enables or disables Multi-AZ deployment.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs46">custom operation: iamAuthentication (bool)

Calls DatabaseInstanceBuilder.IamAuthentication<br /><em>&lt;summary&gt;Enables IAM authentication.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs47">custom operation: storageEncrypted (bool)

Calls DatabaseInstanceBuilder.StorageEncrypted<br /><em>&lt;summary&gt;Enables storage encryption.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs48">custom operation: deletionProtection (bool)

Calls DatabaseInstanceBuilder.DeletionProtection<br /><em>&lt;summary&gt;Enables or disables deletion protection.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs49">field InstanceSize.XLARGE: InstanceSize = 5</div>
<div class="fsdocs-tip" id="fs50">custom operation: backupRetentionDays (float)

Calls DatabaseInstanceBuilder.BackupRetentionDays<br /><em>&lt;summary&gt;Sets the backup retention period in days.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs51">custom operation: enablePerformanceInsights (bool)

Calls DatabaseInstanceBuilder.EnablePerformanceInsights<br /><em>&lt;summary&gt;Enables performance insights.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs52">val tenantId: obj</div>
<div class="fsdocs-tip" id="fs53">val tenantRole: obj</div>
<div class="fsdocs-tip" id="fs54">val users: obj</div>
<div class="fsdocs-tip" id="fs55">val user: obj</div>

    </div>
</main>
<aside id="fsdocs-page-menu">
    <p id="on-this-page">On this page</p>
    <ul>
  <li class="level-1">
    <a href="#Multi-Tenant-SaaS-Architecture-Patterns">
      Multi-Tenant SaaS Architecture Patterns
    </a>
  </li>
  <li class="level-2">
    <a href="#Tenant-Isolation-Strategies">
      Tenant Isolation Strategies
    </a>
  </li>
  <li class="level-3">
    <a href="#Schema-per-Tenant-PostgreSQL">
      Schema-per-Tenant (PostgreSQL)
    </a>
  </li>
  <li class="level-2">
    <a href="#Tenant-Registry-Pattern">
      Tenant Registry Pattern
    </a>
  </li>
  <li class="level-2">
    <a href="#Per-Tenant-Secrets">
      Per-Tenant Secrets
    </a>
  </li>
  <li class="level-2">
    <a href="#Multi-Tenant-Database-Architecture">
      Multi-Tenant Database Architecture
    </a>
  </li>
  <li class="level-3">
    <a href="#Option-1-Schema-per-Tenant-Single-Database">
      Option 1: Schema-per-Tenant (Single Database)
    </a>
  </li>
  <li class="level-3">
    <a href="#PostgreSQL-Schema-Isolation-Pattern">
      PostgreSQL Schema Isolation Pattern
    </a>
  </li>
  <li class="level-3">
    <a href="#Option-2-Database-per-Tenant-Large-Tenants">
      Option 2: Database-per-Tenant (Large Tenants)
    </a>
  </li>
  <li class="level-2">
    <a href="#Tenant-Context-Middleware-Pattern">
      Tenant Context Middleware Pattern
    </a>
  </li>
  <li class="level-2">
    <a href="#Cost-Optimization-by-Tenant-Tier">
      Cost Optimization by Tenant Tier
    </a>
  </li>
  <li class="level-2">
    <a href="#Security-Best-Practices">
      Security Best Practices
    </a>
  </li>
  <li class="level-3">
    <a href="#Tenant-Isolation-Checklist">
      Tenant Isolation Checklist
    </a>
  </li>
  <li class="level-3">
    <a href="#Prevent-Cross-Tenant-Data-Leaks">
      Prevent Cross-Tenant Data Leaks
    </a>
  </li>
  <li class="level-2">
    <a href="#Tenant-Provisioning-Workflow">
      Tenant Provisioning Workflow
    </a>
  </li>
  <li class="level-2">
    <a href="#Monitoring-Multi-Tenant-Systems">
      Monitoring Multi-Tenant Systems
    </a>
  </li>
  <li class="level-2">
    <a href="#Resources">
      Resources
    </a>
  </li>
</ul>
</aside>
<dialog>
    <input type="search" placeholder="Search docs" />
    <div class="results">
        <ul></ul>
        <p class="empty">Type something to start searching.</p>
    </div>
</dialog>
<script type="module" src="https://totallymoney.github.io/FsCDK/content/fsdocs-tips.js"></script>
<script type="module" src="https://totallymoney.github.io/FsCDK/content/fsdocs-theme-toggle.js"></script>
<script type="module" src="https://totallymoney.github.io/FsCDK/content/fsdocs-theme.js"></script>
<script type="module" src="https://totallymoney.github.io/FsCDK/content/fsdocs-search.js"></script>

</body>
</html>